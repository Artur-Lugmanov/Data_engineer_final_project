## Дипломный проект на тему «Разработка ETL-процесса для распознавания мошеннических операций в банковских транзакциях»

### Описание задачи
Разработать ETL процесс, получающий ежедневную выгрузку данных (предоставляется за 3 дня), загружающий ее в хранилище данных и ежедневно строящий отчет.

#### Выгрузка данных
Ежедневно некие информационные системы выгружают три следующих файла:
1. Список транзакций за текущий день. Формат – CSV.
2. Список терминалов полным срезом. Формат – XLSX.
3. Список паспортов, включенных в «черный список» - с накоплением с начала месяца. Формат – XLSX.
Сведения о картах, счетах и клиентах хранятся в СУБД Oracle в схеме BANK. 
Вам предоставляется выгрузка за последние три дня, ее надо обработать. Предполагается что в один день приходит по одному такому файлу. После загрузки соответствующего файла он должен быть переименован в файл с расширением .backup чтобы при следующем запуске файл не искался и перемещен в каталог archive:

#### Построение отчета
По результатам загрузки ежедневно необходимо строить витрину отчетности по мошенническим операциям. Витрина строится накоплением каждый новый отчет укладывается в эту же таблицу с новым report_dt.
В витрине должны содержаться следующие поля:
*event_dt*     Время наступления события.
*passport*     Номер паспорта клиента, совершившего мошенническую операцию.
*fio*          ФИО клиента, совершившего мошенническую операцию.
*phone*        Номер телефона клиента, совершившего мошенническую операцию.
*event_type*   Описание типа мошенничества.
*report_dt*    Время построения отчета.

#### Признаки мошеннических операций.
1. Совершение операции при просроченном или заблокированном паспорте.
2. Совершение операции при недействующем договоре.
3. Совершение операций в разных городах в течение одного часа.
4. Попытка подбора суммы. В течение 20 минут проходит более 3х операций со следующим шаблоном – каждая последующая меньше предыдущей, при этом отклонены все кроме последней. Последняя операция (успешная) в такой цепочке считается мошеннической.

### Решение задачи
Результаты работы находятся в следующих файлах:
[main.py](https://github.com/Artur-Lugmanov/Data_engineer_final_project_SberUniversity/blob/main/main.py)           Файл с основным процессом обработки
[sql_scripts](https://github.com/Artur-Lugmanov/Data_engineer_final_project_SberUniversity/tree/main/sql_scripts)   SQL скрипты, вынесенные в отдельные файлы
   [DDL.sql](https://github.com/Artur-Lugmanov/Data_engineer_final_project_SberUniversity/blob/main/sql_scripts/DDL.sql)       SQL скрипт, для создания необходимых таблиц в DWH
   [report.sql](https://github.com/Artur-Lugmanov/Data_engineer_final_project_SberUniversity/blob/main/sql_scripts/report.sql) SQL скрипт, для подготовки отчета по мошенническим операциям
[main.cron](https://github.com/Artur-Lugmanov/Data_engineer_final_project_SberUniversity/blob/main/main.cron)       Файл для постановки процесса на расписание в формате crontab
[archive](https://github.com/Artur-Lugmanov/Data_engineer_final_project_SberUniversity/tree/main/archive)           Каталог для перемещения обработанных файлов 
